# MySchedule
## 要件定義
「MySchedule」というWebアプリケーションは、スケジュールの管理を行うためのアプリケーションです。

主な機能としては、以下のようなものがあります。

1. 時間割管理機能
ユーザーが履修している講義の時間割を入力することができます。また、講義が変更になった場合には、簡単にスケジュールを修正することができます。

1. 課題管理機能
ユーザーが提出期限のある課題を入力することができます。提出期限が近づいた際には、アラート機能で通知が届くため、課題の締め切りを見落とすことがありません。

1. アルバイト管理機能
ユーザーがアルバイトのシフトを入力することができます。また、シフトが変更になった場合には、簡単にスケジュールを修正することができます。

1. 予定追加機能
ユーザーが自由に予定を追加することができます。授業以外の予定や、個人的な予定などを管理することができます。

1. カレンダー表示機能
各種スケジュールをカレンダー形式で表示することができます。また、週表示や月表示に切り替えることもできます。

1. デザイン性の高いUI
学生をターゲットとしているため、デザイン性の高いUIを採用し、使いやすく、視覚的にも分かりやすいアプリケーションを目指しました。

「MySchedule」は、大学生や専門学生、高校生など、学生をターゲットにしたスケジュール管理アプリケーションです。学生生活に必要なスケジュールを一元管理し、スムーズなスケジュール管理をサポートします。
## タスク
1. 時間割管理機能
    - データモデルの設計と実装
    - 時間割の入力フォームの作成
    - 入力された時間割の表示機能の実装
    - 時間割の編集機能の実装
    - 時間割の削除機能の実装
1. 課題管理機能
    - データモデルの設計と実装
    - 課題の入力フォームの作成
    - 入力された課題の表示機能の実装
    - 課題の編集機能の実装
    - 課題の削除機能の実装
    - アラート機能の実装
1. アルバイト管理機能
    - データモデルの設計と実装
    - アルバイトのシフト入力フォームの作成
    - 入力されたシフトの表示機能の実装
    - シフトの編集機能の実装
    - シフトの削除機能の実装
1. 予定追加機能
    - データモデルの設計と実装
    - 予定入力フォームの作成
    - 入力された予定の表示機能の実装
    - 予定の編集機能の実装
    - 予定の削除機能の実装
1. カレンダー表示機能
    - カレンダー表示用のUIの作成
    - 各種スケジュールのデータの統合処理
    - カレンダー表示機能の実装
1. その他ページ作成
    - ログインページのUIの作成
    - トップページのUIの作成
1. Firebase操作
    - CRUD操作の実装
    - ログイン機能の実装
    - メール送信機能の実装
1. デザイン性の高いUI
    - デザインの設計
    - CSSを用いたUIの実装
## 開発環境
- プログラミング言語  
Typescript
- その他言語  
HTML5,SCSS
- モジュールバンドラ  
Webpack
- データベース  
Firebase  
(JSON形式でデータ管理を行う)
- 公開方法  
Github Pages
### 補足
- オブジェクト指向開発
様々なクラスをインスタンス化して開発を行う。
作成したクラスは最終的にそれぞれの機能の画面(時間割管理など)ごとに1つの関数にまとめてexportする。
そして、その機能の画面ごとに手続きを選び、index.tsで最終的に実行する。
- UI作成
DOM操作を行うことによって、index.htmlの中身を作成し、それぞれの画面の機能を実装する。
- SCSSについて  
scss記法については[こちら](https://webst8.com/blog/sass-scss/#SCSS)
## ディレクトリ
### ディレクトリ構造
```bash
├── src/
│   ├── scss/
│   │   └── style.scss                   # 全体のスタイルシートのSCSS
│   ├── components/
│   │   ├── Timetable/                   # 時間割機能のコンポーネントを入れるディレクトリ
│   │   ├── Task/                        # 課題機能のコンポーネントを入れるディレクトリ
│   │   ├── Shift/                       # アルバイトシフト機能のコンポーネントを入れるディレクトリ
│   │   ├── Event/                       # 予定機能のコンポーネントを入れるディレクトリ
│   │   ├── Calendar/                    # カレンダー機能のコンポーネントを入れるディレクトリ
│   │   ├── Login/                       # ログイン機能のコンポーネントを入れるディレクトリ
│   │   │   └── LoginForm.ts             # ログインページのform要素のコンポーネント
│   │   ├── Register/                    # アカウント登録機能のコンポーネントを入れるディレクトリ
│   │   │   └── RegisterForm.ts          # アカウント登録ページのform要素のコンポーネント
│   │   └── Ui/
│   │       ├── Input.ts                 # input要素のコンポーネント
│   │       ├── Label.ts                 # label要素のコンポーネント
│   │       ├── LabeledInput.ts          # input要素とlabel要素のコンポーネント
│   │       ├── PasswordInput.ts         # パスワードを入力するinput要素を含んだ要素のコンポーネント
│   │       ├── Button.ts                # button要素のコンポーネント
│   │       ├── SubmitButton.ts          # submitボタン要素のコンポーネント
│   │       ├── Form.ts                  # form要素のコンポーネント
│   │       ├── LoginForm.ts             # ログインページのform要素のコンポーネント
│   │       └── RegisterForm.ts          # アカウント登録ページのform要素のコンポーネント
│   ├── containers/
│   │   ├── Content/
│   │   │   ├── TimetableContainer.ts    # 時間割管理ページのコンテナ
│   │   │   ├── TaskContainer.ts         # 課題管理ページのコンテナ
│   │   │   ├── ShiftContainer.ts        # アルバイト管理ページのコンテナ
│   │   │   ├── ShiftContainer.ts        # アルバイト管理ページのコンテナ
│   │   │   ├── EventContainer.ts        # 予定管理ページのコンテナ
│   │   │   ├── CalendarContainer.ts     # カレンダーページのコンテナ
│   │   │   ├── LoginContainer.ts        # ログインページのコンテナ
│   │   │   └── RegisterContainer.ts     # アカウント登録ページのコンテナ
│   │   └── Page/
│   │       ├── Header.ts                # タブバーのコンポーネント
│   │       ├── Content.ts               # コンテンツのコンポーネント
│   │       ├── Footer.ts                # 操作ボタンのコンポーネント
│   │       └── Page.ts                  # ページのコンポーネント
│   ├── lib/
│   │   └── firebase/
│   │       └── firebase.ts              # firebaseのライブラリ
│   ├── utils/
│   │   ├── application .ts              # アプリ立ち上げ用のユーティリティ
│   │   ├── DbController.ts              # データベース操作用のユーティリティ
│   │   ├── AppUser.ts                   # ユーザー操作用のユーティリティ
│   │   ├── domUtils.ts                  # DOM 操作用のユーティリティ
│   │   ├── pageUtils.ts                 # ページ操作用のユーティリティ
│   │   ├── types.ts                     # 型定義
│   │   └── constants.ts                 # アプリ全体で使用される定数
│   └── index.ts                         # アプリのエントリーポイント
├── dist/
│   ├── index.html                       # メインページのHTML
│   └── favicon.ico                      # アプリのアイコン
├── package.json                         # アプリの依存関係やスクリプトの定義
├── tsconfig.json                        # TypeScriptのコンパイル設定
└── webpack.config.js                    # Webpackの設定
```
### 用語説明
- コンポーネント  
UI（ユーザーインターフェース）を構成する最小単位の部品であり、再利用性が高く、独立した機能を持つように設計されたクラスまたは関数のことを指します。

- コンテナ  
コンポーネントをまとめ、UI全体を構成するためのもので、通常は複数のコンポーネントを組み合わせたり、またはコンポーネントとロジックを組み合わせたりすることができます。

要するに、例えば時間割管理機能に焦点を当てると、  
TimetableForm.ts(時間割管理の入力プログラム)とTimetableList.ts(時間割管理の一覧表示プログラム)を作成して、  
それらを組み合わせて、TimetableContainer.tsを動作させることによって、  
時間割管理機能を実装していく形です。

ただし、トップページ,ログインページ,カレンダーページに関しては入力プログラムを作成する必要がないため、  
直接コンポーネントを用意する形となります。
## データベースのディレクトリ構造
### ディレクトリ構造
```bash
└── https://myschedule-c0a49-default-rtdb.firebaseio.com/
    └── users/
        ├── user0Id
        │   ├── timetable
        │   │   └── timeTables #配列
        │   ├── task
        │   │   ├── tasks #配列
        │   │   └── alertSettings
        │   │       ├── enabled #プロパティ
        │   │       └── daysBeforeDeadline #プロパティ
        │   ├── shift
        │   │   └── shifts #配列
        │   └── event
        │   │   └── eventSchedules #配列
        └── user1Id
            ├── timetable
            ├── task
            ├── shift
            └── event
```
### デザイン設計
- font-size  
    基本16px,大文字24px
- 各要素間のmargin  
    基本10px,大間隔15px
- input要素のpadding  
    水平方向8px,垂直方向4px
- input要素とlabel要素の間のmargin  
    8px
- button要素のpadding  
    水平方向12px,垂直方向8px
- 画面下のサイドメニュー(ログアウトボタンなどが表示されているメニューバー)のheight
    14px(フォント)+8px(ボタンのpadding)×2+10px(各要素のmargin)×2  
    =40px

### 補足
- データベース操作について  
データベース操作については、  
firebaseのメールアドレス認証を用いてuserのuidを取得し、  
ユーザーごとに作成したディレクトリ以下のjsonファイル(timetable.json,task.json,shift.json,event.json)それぞれに、  
api.tsよりDbControllerをインスタンス化してCRUD操作を行う。  
(timetable.jsonに対してはtimetable用のインスタンスを作成するなど)
- ユーザー操作について  
ユーザー操作については、  
api.tsよりUserをインスタンス化してログイン処理やメール送信等を行う。
## 設計の補足等
実装するクラスや関数の機能についての補足を行う。
- api.ts  
    - Fetch APIを用いたFirebaseとのCRUD操作
    - Firebaseによる、メールアドレスとパスワードを用いたユーザー認証
    - ユーザーのメールアドレスを用いたメール送信
- ユーザーの認証状態について
    - appUser.signIn()をしなくても、一度サインインをすれば認証状態が保持される  
    そのため、ユーザーの認証状態を確認し、認証状態でなければログインページにリダイレクトし、  
    ログインページでappUser.signIn()やappUser.signUp()を行うことになる。
- クエリ文字列(URLパラメータ)について
    - クエリ文字列とは
    例えば、基本のURLが「https://○△×□.jp/」だとして、  
    基本のURLにクエリ文字列（URLパラメーター）を加えると  「https://○△×□.jp/?●=▲×■&○=△×□」となります。 
    - 動的なページ結果の表示(アクティブパラメーター)
    今回のWebアプリにおいては、  
    パラメーターをつけ加えて、Webサイトの表示内容を変更するためにクエリ文字列を使用します。  
    (詳しいコードはdomUtils.tsのPageUtilsクラスを参照)  
    以下は、今回使用するクエリ文字列の例です
        - トップページ
        https://CA01971172.github.io/MySchedule/dist/index.html
        - ログインページ
        https://CA01971172.github.io/MySchedule/dist/index.html?page=login
        - 時間割管理ページ(一覧表示)
        https://CA01971172.github.io/MySchedule/dist/index.html?page=timetable
        - 時間割管理ページ(入力フォーム)
        https://CA01971172.github.io/MySchedule/dist/index.html?page=timetable&mode=edit
- 日付データの取り扱いについて
    データベースに保存する日付データについては、
    DateオブジェクトのgetTime()メソッドを使用し、number型の日付データで取得したものをアップロードすること。
    ```ts
    const deadlineDate: Date = new Date(2023, 6, 30);
    let deadlineTimestamp: number = 0;
    deadlineTimestamp = deadlineDate.getTime();
    ```
    逆に、データベースからダウンロードしたタイムスタンプは以下のように変換し、扱うこと。
    ```ts
    const deadlineTimestamp: number = 1696089600000; // 2023/7/1 00:00:00
    const deadlineDate: Date = new Date(deadlineTimestamp);
    console.log(deadlineDate); // 結果: Fri Jun 30 2023 15:00:00 GMT-0900 (日本標準時)
    ```
- 開発時の注意点
    - ユーザーは認証状態として開発を行う。
    - 認証状態でない場合、ログインページにリダイレクトされてしまう。  
        そのため、以下のコードでユーザーを認証状態にし、開発を行うこと。
        ```ts
        /* ユーザー情報のセッティング */
        const hogeUser:AppUser = new AppUser()
        hogeUser.setUserInfo("使用するメールアドレス","ユーザーのパスワード")

        /* 以下の行から1行選んで、ユーザー認証に対する処理を実行する */

        //ユーザー登録したい場合はこの行を実行
        hogeUser.signUp()

        //ログインしたい場合はこの行を実行
        hogeUser.signIn()//ログイン

        //ログアウトしたい場合はこの行を実行
        hogeUser.signOut()//ログアウト
        ```
        (ユーザーは1度ログインすればログアウトするかcookieが切れるまでログイン状態のまま。詳しくは「ユーザーの認証状態について」を参照)  
    - 各機能に対応するページの選択  
        各機能のページは、URLの末尾にクエリ文字列を追加することで、リンクを特定して表示しています。  
        つまり、/index.htmlに続くクエリ文字列で、ページの選択が行われます。  
        そのため、各自実装したページを閲覧したい場合には、正しいクエリ文字列を入力したリンクを開いてください。
        (詳しい例などは「クエリ文字列について」を参照)